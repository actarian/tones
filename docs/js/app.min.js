!function(){"use strict";if(Detector.webgl){var t,n,a,o,i,r,s,d,l,p,h,c,w,u,E,m,f,T,M={DIFFUSE:0,BUMP:1,LIGHT:2,ALPHA:3,METAL:4},g=window.performance||Date,v=[],S=(new Tone.Volume(-100),function(){var i=new Tone.Filter({type:"lowpass",frequency:350,rolloff:-12,Q:1,gain:0}).toMaster(),t=new Tone.Player({url:"audio/The-Blinding-Shiver-128.[mp3|ogg]",loop:!0,playbackRate:.1}).toMaster().sync().start("0");Tone.Transport.timeSignature=4,Tone.Transport.bpm.value=98,Tone.Transport.loop=!0,Tone.Transport.loopStart="0",Tone.Transport.loopEnd="98:5";var r=new Tone.DuoSynth({vibratoAmount:.5,vibratoRate:5,portamento:.1,harmonicity:1.005,volume:1,voice0:{volume:-2,oscillator:{type:"sawtooth"},filter:{Q:1,type:"lowpass",rolloff:-24},envelope:{attack:.01,decay:.25,sustain:.4,release:1.2},filterEnvelope:{attack:.001,decay:.05,sustain:.3,release:2,baseFrequency:100,octaves:4}},voice1:{volume:-10,oscillator:{type:"sawtooth"},filter:{Q:2,type:"bandpass",rolloff:-12},envelope:{attack:.25,decay:4,sustain:.1,release:.8},filterEnvelope:{attack:.05,decay:.05,sustain:.7,release:2,baseFrequency:5e3,octaves:-1.5}}}).toMaster();r.notes=["C2","E2","G2","A2","C3","D3","E3","G3","A3","B3","C4","D4","E4","G4","A4","B4","C5"],r.note=r.notes[0];var s={effects:{filter:i},instruments:{player:t,synth:r},start:function(){Tone.Transport.start("+0.1")},stop:function(){Tone.Transport.pause()},theremin:{drag:function(e){e=e.divideScalar(10);var t=Math.abs(e.x),n=Math.abs(e.z);t=Math.max(0,Math.min(1,t)),n=Math.max(0,Math.min(1,n));var a=Math.max(0,Math.min(r.notes.length-1,Math.round(n*r.notes.length-1))),o=r.notes[r.notes.length-1-a];r.note!==o&&(r.note=o,r.setNote(o)),r.vibratoAmount.value=10*t,1===s.speed&&i.set("detune",2e4*t-1e4)},start:function(){r.triggerAttack(r.note)},stop:function(){r.triggerRelease()}},speed:0,setSpeed:function(e){e=Math.max(0,Math.min(1,e)),t.set("playbackRate",.1+.99*e),i.set("detune",1e4*e-1e4)}};return s}()),R=[],H=[];e(),b(),window.addEventListener("resize",function(){t.resize(),a.setSize(window.innerWidth,window.innerHeight)},!1)}else Detector.addGetWebGLMessage();function e(){var e;(n=new THREE.Scene).add(new THREE.AmbientLight(4473924)),(e=new THREE.PerspectiveCamera(20,window.innerWidth/window.innerHeight,.01,1e3)).position.set(0,300,0),e.lookAt(0,0,0),e.resize=function(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix()},window.camera=e,n.add(e),t=e,(r=new THREE.SpotLight(16711422,1,1e3,1,1,.1)).position.set(35,50,-35),r.castShadow=!0,r.shadow.mapSize.width=2048,r.shadow.mapSize.height=2048,r.shadow.camera.near=.1,r.shadow.camera.far=500,r.shadow.radius=1.0001,n.add(r),s=new THREE.PlaneGeometry(500,500,25,25),d=new THREE.ShadowMaterial({opacity:.25,side:THREE.DoubleSide}),(l=new THREE.Mesh(s,d)).rotation.set(-Math.PI/2,0,0),l.position.set(0,0,-1),l.receiveShadow=!0,n.add(l),(u=(new THREE.TextureLoader).load("img/envMap-sm.jpg")).mapping=THREE.EquirectangularReflectionMapping,u.magFilter=THREE.LinearFilter,u.minFilter=THREE.LinearMipMapLinearFilter,s=new THREE.SphereGeometry(1,64,64),d=new THREE.MeshStandardMaterial({color:9670284,roughness:.6,metalness:.1,opacity:1,transparent:!1}),d=new THREE.MeshStandardMaterial({color:6710886,roughness:.2,metalness:.95,envMap:u,envMapIntensity:1}),(p=new THREE.Mesh(s,d)).position.set(0,1,0),p.receiveShadow=!1,p.castShadow=!0,n.add(p),R.push(p),s=new THREE.BoxGeometry(3,3,3),d=new THREE.MeshStandardMaterial({color:16777215,roughness:.6,metalness:.1,opacity:1,transparent:!1}),(h=new THREE.Mesh(s,d)).position.set(-35,1.5,35),h.receiveShadow=!1,h.castShadow=!0,n.add(h),H.push(h),E=y(M.BUMP),f=y(M.LIGHT,512),m=y(M.DIFFUSE,512),T=y(M.LIGHT,512),s=new THREE.RingGeometry(12.1,45,64,4),d=new THREE.MeshStandardMaterial({color:3091755,map:m,bumpMap:E,bumpScale:.02,envMap:u,roughness:1,roughnessMap:f,metalness:1,metalnessMap:T}),(c=new THREE.Mesh(s,d)).position.set(0,.1,0),c.rotation.set(-Math.PI/2,0,0),c.receiveShadow=!0,c.castShadow=!0,m=(new THREE.TextureLoader).load("img/disc.jpg"),s=new THREE.RingGeometry(1.3,12,64,4),d=new THREE.MeshStandardMaterial({color:16777215,map:m,roughness:.6,metalness:.4}),(w=new THREE.Mesh(s,d)).position.set(0,0,0),w.receiveShadow=!0,w.castShadow=!0,c.add(w),n.add(c),(a=new THREE.WebGLRenderer({antialias:!0,alpha:!0})).setPixelRatio(window.devicePixelRatio),a.setSize(window.innerWidth,window.innerHeight),a.shadowMap.enabled=!0,a.gammaInput=!0,a.gammaOutput=!0,a.shadowMap.type=THREE.PCFSoftShadowMap,document.querySelector(".section-scene").appendChild(a.domElement),(i=new THREE.DragControls(H,t,a.domElement)).addEventListener("dragstart",function(e){o&&(o.enabled=!1),S.start(),S.theremin.start()}),i.addEventListener("drag",function(e){var t=h.position.clone(),n=p.position.clone(),a=t.sub(n);S.theremin.drag(a),0===S.speed&&TweenLite.to(S,.5,{speed:1,ease:Power2.easeOut,onUpdate:function(){S.setSpeed(S.speed)}})}),i.addEventListener("dragend",function(e){o&&(o.enabled=!0),0!==S.speed&&TweenLite.to(S,.5,{speed:0,ease:Power2.easeOut,onUpdate:function(){S.setSpeed(S.speed)},onComplete:function(){S.theremin.stop(),S.stop()}})})}function y(e,t){var n=t=t||2048,a=t,o=document.createElement("canvas");o.width=n,o.height=a;var i=o.getContext("2d"),r=n/2,s=a/2,d=t/2*.3,l=t/2*.99;function p(e,t,n,a){i.beginPath(),i.arc(r,s,e,0,2*Math.PI,!1),t&&(i.fillStyle=t,i.fill()),n&&(i.lineWidth=a,i.strokeStyle=n,i.stroke()),i.closePath()}if(e===M.DIFFUSE&&(i.fillStyle="#2f2d2b",i.rect(0,0,n,a),i.fill(),p(d,"#332d2a")),e===M.METAL&&(i.fillStyle="#000000",i.rect(0,0,n,a),i.fill(),p(d,"#f0f0f0")),e===M.LIGHT){i.fillStyle="#000000",i.rect(0,0,n,a),i.fill();for(var h=d;h<l;h+=10+30*Math.random())p(h+.2*Math.random(),null,"rgba(255, 255, 255, "+.5*Math.random()+")",10+40*Math.random())}if(e===M.BUMP){i.fillStyle="#000000",i.rect(0,0,n,a),i.fill();for(h=d;h<l;h+=2)p(h+.2*Math.random(),null,"rgba(255, 255, 255, "+.5*Math.random()+")",.6)}return new THREE.CanvasTexture(o)}function b(){requestAnimationFrame(b);var e=.0575959*60/(function(){for(var e=g.now();0<v.length&&v[0]<=e-1e3;)v.shift();return v.push(e),v.length}()||60);p.rotation.y+=e*S.speed,c.rotation.z+=e*S.speed,r.position.x+=(-1*h.position.x-r.position.x)/20,r.position.z+=(-1*h.position.z-r.position.z)/20,a.render(n,t)}}();
//# sourceMappingURL=app.min.js.map
